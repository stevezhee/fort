;; ┌┬┐┬ ┬┌─┐┌─┐┌─┐
;;  │ └┬┘├─┘├┤ └─┐
;;  ┴  ┴ ┴  └─┘└─┘

UInt32 = /unsigned 32
Pointer = /address (/unsigned 32)
RealWorld = /unsigned 1

;; ┌─┐┬─┐┬┌┬┐┬┌┬┐┬┬  ┬┌─┐┌─┐
;; ├─┘├┬┘│││││ │ │└┐┌┘├┤ └─┐
;; ┴  ┴└─┴┴ ┴┴ ┴ ┴ └┘ └─┘└─┘

load_volatile: /address a -> a
store_volatile: (/address a, a) -> ()

inttoptr: UInt32 -> Pointer
ptrtoint: Pointer -> UInt32

;; ┌─┐┌─┐┌─┐┬─┐┌─┐┌┬┐┌─┐┬─┐┌─┐
;; │ │├─┘├┤ ├┬┘├─┤ │ │ │├┬┘└─┐
;; └─┘┴  └─┘┴└─┴ ┴ ┴ └─┘┴└─└─┘

+ = add
add: (UInt32, UInt32) -> UInt32

<< = shift_left
shift_left: (UInt32, UInt32) -> UInt32

& = bitwise_and
bitwise_and: (UInt32, UInt32) -> UInt32

| = bitwise_or
bitwise_or: (UInt32, UInt32) -> UInt32

;; ┌─┐┌─┐┌┐┌┌─┐┌┬┐┌─┐┌┐┌┬┐┌─┐
;; │  │ ││││└─┐ │ ├─┤││││ └─┐
;; └─┘└─┘┘└┘└─┘ ┴ ┴ ┴┘└┘┴ └─┘

periph_base: UInt32 = 1073741824 ;; 0x40000000
cmu_base: UInt32 = periph_base + 209715200 ;; 0xc8000
wdog_base: UInt32 = periph_base + 142606336 ;; 0x88000

;; ┌─┐┬ ┬┌┐┌┌─┐┌┬┐┬┌─┐┌┐┌┌─┐
;; ├┤ │ │││││   │ ││ ││││└─┐
;; └  └─┘┘└┘└─┘ ┴ ┴└─┘┘└┘└─┘

set_register: (UInt32, UInt32) -> () = \(a,b) => /do
  /let pointer = inttoptr a
  store_volatile (pointer, b)

test: RealWorld -> () = \w => /do
  set_register (wdog_base, 0)
